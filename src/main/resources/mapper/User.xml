<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.itupo.iiv.dao.UserDao">
     <select id="readUser" parameterType="String" resultType="io.itupo.iiv.domain.UserBean">
          SELECT * FROM user WHERE username = #{username}
     </select>
     
     <select id="readAuthority" parameterType="String" resultType="String">
          SELECT authority_name FROM authority WHERE username = #{username}
     </select>
     
     <insert id="registerUser" parameterType="io.itupo.iiv.domain.UserBean">
		INSERT INTO user (username, password, firstname, lastname, email, year) 
		VALUE (#{username}, #{password}, #{firstname}, #{lastname}, #{email}, #{year})
	</insert>
	
	<update id="updateUser" parameterType="io.itupo.iiv.domain.UserBean">
		UPDATE user
		SET firstname = #{firstname}, lastname = #{lastname}, email = #{email}, year = #{year}
		WHERE id = #{id}
	</update>
	
	<update id="updatePassword" parameterType="io.itupo.iiv.dto.UserDto">
		UPDATE user
		SET password = #{password}
		WHERE username = #{username}
	</update>
	
	<insert id="registerAuthority" parameterType="io.itupo.iiv.domain.UserBean">
		INSERT INTO authority (username, authority_name) 
		VALUE (#{username}, #{level})
	</insert>
	
     <select id="readUsernameById" parameterType="int" resultType="String">
          SELECT username FROM user WHERE id = #{id}
     </select>
     
     <select id="checkUsername" parameterType="String" resultType="int">
          SELECT count(username) FROM user WHERE username = #{username}
     </select>
     
	<select id="checkPassword" parameterType="io.itupo.iiv.dto.UserDto" resultType="int">
          SELECT count(username) FROM user WHERE username = #{username} AND password = #{password}
	</select>
     
     <select id="readUserById" parameterType="int" resultType="io.itupo.iiv.domain.UserBean">
          SELECT * FROM user WHERE id = #{id}
     </select> 
	<select id="readUserByUsername" parameterType="String" resultType="io.itupo.iiv.domain.UserBean">
          SELECT * FROM user WHERE username = #{username}
     </select> 
</mapper>